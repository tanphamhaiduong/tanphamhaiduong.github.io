webpackJsonp([22,65],{1161:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1162);n.d(e,"queue",function(){return r.a})},1162:function(t,e,n){"use strict";e.a=l;var r=n(1163),s={};function a(t){this._size=t,this._call=this._error=null,this._tasks=[],this._data=[],this._waiting=this._active=this._ended=this._start=0}function i(t){if(!t._start)try{!function(t){for(;t._start=t._waiting&&t._active<t._size;){var e=t._ended+t._active,n=t._tasks[e],r=n.length-1,a=n[r];n[r]=o(t,e),--t._waiting,++t._active,n=a.apply(null,n),t._tasks[e]&&(t._tasks[e]=n||s)}}(t)}catch(e){if(t._tasks[t._ended+t._active-1])u(t,e);else if(!t._data)throw e}}function o(t,e){return function(n,r){t._tasks[e]&&(--t._active,++t._ended,t._tasks[e]=null,null==t._error&&(null!=n?u(t,n):(t._data[e]=r,t._waiting?i(t):c(t))))}}function u(t,e){var n,r=t._tasks.length;for(t._error=e,t._data=void 0,t._waiting=NaN;--r>=0;)if((n=t._tasks[r])&&(t._tasks[r]=null,n.abort))try{n.abort()}catch(e){}t._active=NaN,c(t)}function c(t){if(!t._active&&t._call){var e=t._data;t._data=void 0,t._call(t._error,e)}}function l(t){if(null==t)t=1/0;else if(!((t=+t)>=1))throw new Error("invalid concurrency");return new a(t)}a.prototype=l.prototype={constructor:a,defer:function(t){if("function"!==typeof t)throw new Error("invalid callback");if(this._call)throw new Error("defer after await");if(null!=this._error)return this;var e=r.a.call(arguments,1);return e.push(t),++this._waiting,this._tasks.push(e),i(this),this},abort:function(){return null==this._error&&u(this,new Error("abort")),this},await:function(t){if("function"!==typeof t)throw new Error("invalid callback");if(this._call)throw new Error("multiple await");return this._call=function(e,n){t.apply(null,[e].concat(n))},c(this),this},awaitAll:function(t){if("function"!==typeof t)throw new Error("invalid callback");if(this._call)throw new Error("multiple await");return this._call=t,c(this),this}}},1163:function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=[].slice},2673:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(2810);e.default=r.a},2810:function(t,e,n){"use strict";n(289);var r,s=n(22),a=(n(168),n(83)),i=(n(1096),n(616)),o=(n(399),n(291)),u=(n(92),n(77)),c=(n(1164),n(617)),l=(n(239),n(167)),d=(n(290),n(241)),f=n(0),p=(n.n(f),n(41)),h=(n.n(p),n(146)),m=(n.n(h),n(1161)),_=n(145),g=(n.n(_),n(1179)),b=n(100),y=n(130),v=n(129),I=n(2811),w=n(224),E=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),P=this&&this.__assign||Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var s in e=arguments[n])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t},$=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(s,a){function i(t){try{u(r.next(t))}catch(t){a(t)}}function o(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){t.done?s(t.value):new n(function(e){e(t.value)}).then(i,o)}u((r=r.apply(t,e||[])).next())})},S=this&&this.__generator||function(t,e){var n,r,s,a,i={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(s=r[2&a[0]?"return":a[0]?"throw":"next"])&&!(s=s.call(r,a[1])).done)return s;switch(r=0,s&&(a=[0,s.value]),a[0]){case 0:case 1:s=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(s=(s=i.trys).length>0&&s[s.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!s||a[1]>s[0]&&a[1]<s[3])){i.label=a[1];break}if(6===a[0]&&i.label<s[1]){i.label=s[1],s=a;break}if(s&&i.label<s[2]){i.label=s[2],i.ops.push(a);break}s[2]&&i.ops.pop(),i.trys.pop();continue}a=e.call(t,i)}catch(t){a=[6,t],r=0}finally{n=s=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}},R=function(t){function e(e){var n=t.call(this,e)||this;return n.isHideSubmitting=function(){n.setState({isSubmitting:!1})},n.isResetProgressBar=function(){n.setState({isSubmitting:!0,progress:0,report:[]})},n.getReportData=function(t,e){var r=t.userIds,s=t.dateProcessing,a=t.statusIds,i=t.index;return g.a.query({query:I.b,variables:{userIds:r,dateProcessing:s,statusIds:a,limit:y.l.ITEMS_PER_PAGE,offset:(i-1)*y.l.ITEMS_PER_PAGE}}).then(function(t){var r=t.data,s=n.state,a=s.report,i=s.totalReportRecords,o=0;i>0&&(o=Math.floor(100*(r.report.length+a.length)/i)),n.setState({report:a.concat(r.report),progress:o<=100?o:0}),e()}).catch(function(t){console.error(t),e()})},n.handleSubmit=function(t){t.preventDefault(),n.props.form.validateFields(function(t,e){return $(n,void 0,void 0,function(){var n,r,s,a,i,o,u,c,l=this;return S(this,function(f){switch(f.label){case 0:if(t)return[3,4];f.label=1;case 1:return f.trys.push([1,3,,4]),this.isResetProgressBar(),n=e.dateProcessing,r=h.get(this.props.data,"statusGroup.statusesInGroup","").split(","),s=this.props.data.users.map(function(t){return t.id}),[4,g.a.query({query:I.c,variables:{userIds:s,dateProcessing:n,statusIds:r}})];case 2:if(a=f.sent().data,(i=a.totalReportRecords)<1)return this.isHideSubmitting(),[2,d.a.info({message:"L\u1ed7i",description:"Kh\xf4ng c\xf3 d\u1eef li\u1ec7u \u0111\u1ec3 l\u1ea5y"})];for(this.setState({totalReportRecords:i}),o=m.queue(1),u=1;u<=Math.ceil(i/y.l.ITEMS_PER_PAGE);u++)o.defer(this.getReportData,{userIds:s,dateProcessing:n,statusIds:r,index:u});return o.awaitAll(function(){var t=l.state.report,e=Object(v.v)(t,Object(v.t)(l.props.userLoggedIn.role.permissions,y.e.ADMIN));l.isHideSubmitting(),Object(v.n)(e,"customers","report"+p(Date.now()).format("DDMMMYYYY").toString())}),[3,4];case 3:return c=f.sent(),console.error(c),this.isHideSubmitting(),Object(v.o)(c),[3,4];case 4:return[2]}})})})},n.state={report:[],isSubmitting:!1,progress:0,totalReportRecords:0},n}return E(e,t),e.prototype.render=function(){var t={name:"/reports/group/customers",label:"Xu\u1ea5t b\xe1o c\xe1o nh\xf3m",breadCumData:[{id:1,text:"Trang Ch\u1ee7",link:"/"},{id:2,text:"B\xe1o c\xe1o nh\xf3m",link:"/reports/group/customers"}]},e=this.props,n=e.form,r=e.data.loading;return f.createElement("div",null,f.createElement(l.a,{className:"content-header"},t.label,f.createElement(b.c,{breadCumData:t.breadCumData})),f.createElement(l.a,{className:"content-body animated fadeIn"},r?f.createElement(b.o,{size:"large"}):f.createElement("div",null,f.createElement(c.a,{percent:this.state.progress,status:"active"}),f.createElement(u.a,{onSubmit:this.handleSubmit},f.createElement(l.a,{gutter:16},f.createElement(o.a,{xs:24,sm:24,md:24,lg:10},f.createElement(u.a.Item,{label:"Ng\xe0y x\u1eed l\xfd"},n.getFieldDecorator("dateProcessing")(f.createElement(i.a.RangePicker,{format:"YYYY-MM-DD HH:mm",showTime:{format:"HH"},placeholder:["Start Time","End Time"]})))),f.createElement(o.a,{xs:24,sm:24,md:24,lg:4},f.createElement(u.a.Item,null,f.createElement(a.a,{type:"primary",htmlType:"submit",loading:this.state.isSubmitting,disabled:Object(v.z)(this.props)},f.createElement(s.a,{type:"download"}),"L\u1ea5y d\u1eef li\u1ec7u"))))))))},e}(f.PureComponent);e.a=Object(_.compose)(Object(w.connect)(function(t,e){return P({userLoggedIn:t.auth.userLoggedIn},e)},null),Object(_.graphql)(I.a,{options:function(){return{variables:{name:y.k.CHANGED_STATUS}}}}),u.a.create())(R)},2811:function(t,e,n){"use strict";n.d(e,"a",function(){return l}),n.d(e,"c",function(){return d}),n.d(e,"b",function(){return f});var r,s,a,i=n(128),o=n.n(i),u=n(160),c=this&&this.__makeTemplateObject||function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},l=o()(r||(r=c(["\n  ","\n  query GroupReportQueries($name: String!) {\n    statusGroup(name: $name) {\n      ...StatusGroup\n    }\n    users {\n      id\n    }\n  }\n"],["\n  ","\n  query GroupReportQueries($name: String!) {\n    statusGroup(name: $name) {\n      ...StatusGroup\n    }\n    users {\n      id\n    }\n  }\n"])),u.k),d=o()(s||(s=c(["\n  query TotalRecordReportQuery(\n    $userIds: [ID!]\n    $statusIds: [ID!]\n    $dateProcessing: [String!]\n  ) {\n    totalReportRecords(\n      userIds: $userIds\n      statusIds: $statusIds\n      dateProcessing: $dateProcessing\n    )\n  }\n"],["\n  query TotalRecordReportQuery(\n    $userIds: [ID!]\n    $statusIds: [ID!]\n    $dateProcessing: [String!]\n  ) {\n    totalReportRecords(\n      userIds: $userIds\n      statusIds: $statusIds\n      dateProcessing: $dateProcessing\n    )\n  }\n"]))),f=o()(a||(a=c(["\n  ","\n  query ReportQuery(\n    $userIds: [ID!]\n    $statusIds: [ID!]\n    $dateProcessing: [String!]\n    $limit: Int!\n    $offset: Int!\n  ) {\n    report(\n      userIds: $userIds\n      statusIds: $statusIds\n      dateProcessing: $dateProcessing\n      limit: $limit\n      offset: $offset\n    ) {\n      ...Customer\n      user {\n        id\n        name\n        licenseNumber\n        supervisor {\n          id\n          name\n          phoneNumber\n        }\n      }\n    }\n  }\n"],["\n  ","\n  query ReportQuery(\n    $userIds: [ID!]\n    $statusIds: [ID!]\n    $dateProcessing: [String!]\n    $limit: Int!\n    $offset: Int!\n  ) {\n    report(\n      userIds: $userIds\n      statusIds: $statusIds\n      dateProcessing: $dateProcessing\n      limit: $limit\n      offset: $offset\n    ) {\n      ...Customer\n      user {\n        id\n        name\n        licenseNumber\n        supervisor {\n          id\n          name\n          phoneNumber\n        }\n      }\n    }\n  }\n"])),u.c)}});