webpackJsonp([29],{2675:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(2779);e.default=r.a},2779:function(t,e,n){"use strict";n(228);var r,a=n(19),s=(n(135),n(74)),o=(n(1099),n(618)),i=(n(399),n(290)),u=(n(92),n(78)),c=(n(1100),n(404)),p=(n(227),n(164)),l=(n(292),n(244)),d=n(0),m=(n.n(d),n(109)),f=(n.n(m),n(680)),g=n(41),h=(n.n(g),n(102)),b=(n.n(h),n(149)),y=n(93),P=n(108),I=n(1101),$=n(107),S=n(2780),E=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),v=this&&this.__assign||Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t},A=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(a,s){function o(t){try{u(r.next(t))}catch(t){s(t)}}function i(t){try{u(r.throw(t))}catch(t){s(t)}}function u(t){t.done?a(t.value):new n(function(e){e(t.value)}).then(o,i)}u((r=r.apply(t,e||[])).next())})},R=this&&this.__generator||function(t,e){var n,r,a,s,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"===typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(s){return function(i){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=r[2&s[0]?"return":s[0]?"throw":"next"])&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[0,a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,i])}}},_=function(t){function e(e){var n=t.call(this,e)||this;return n.isHideSubmitting=function(){n.setState({isSubmitting:!1})},n.isResetProgressBar=function(){n.setState({isSubmitting:!0,progress:0,report:[]})},n.getReportData=function(t,e){var r=t.dateAppointment,a=t.dateProcessing,s=t.statusIds,o=t.index;return I.a.query({query:S.b,variables:{dateAppointment:r,dateProcessing:a,statusIds:s,limit:P.TABLE.ITEMS_PER_PAGE,offset:(o-1)*P.TABLE.ITEMS_PER_PAGE}}).then(function(t){var r=t.data,a=n.state,s=a.report,o=a.totalReportRecords,i=0;o>0&&(i=Math.floor(100*(r.report.length+s.length)/o)),n.setState({report:s.concat(r.report),progress:i<=100?i:0}),e()}).catch(function(t){console.error(t),e()})},n.handleSubmit=function(t){t.preventDefault(),n.props.form.validateFields(function(t,e){return A(n,void 0,void 0,function(){var n,r,a,s,o,i,u,c,p=this;return R(this,function(d){switch(d.label){case 0:if(t)return[3,4];d.label=1;case 1:return d.trys.push([1,3,,4]),this.isResetProgressBar(),n=e.dateAppointment,r=e.dateProcessing,a=m.get(this.props.data,"statusGroup.statusesInGroup","").split(","),[4,I.a.query({query:S.c,variables:{dateAppointment:n,dateProcessing:r,statusIds:a}})];case 2:if(s=d.sent().data,(o=s.totalReportRecords)<1)return this.isHideSubmitting(),[2,l.a.info({message:"L\u1ed7i",description:"Kh\xf4ng c\xf3 d\u1eef li\u1ec7u \u0111\u1ec3 l\u1ea5y"})];for(this.setState({totalReportRecords:o}),i=f.queue(1),u=1;u<=Math.ceil(o/P.TABLE.ITEMS_PER_PAGE);u++)i.defer(this.getReportData,{dateAppointment:n,dateProcessing:r,statusIds:a,index:u});return i.awaitAll(function(){var t=p.state.report,e=Object($.z)(t,Object($.q)(p.props.userLoggedIn.role.permissions));p.isHideSubmitting(),Object($.n)(e,"customers","report"+g(Date.now()).format("DDMMMYYYY").toString())}),[3,4];case 3:return c=d.sent(),console.error(c),this.isHideSubmitting(),Object($.o)(c),[3,4];case 4:return[2]}})})})},n.state={report:[],isSubmitting:!1,progress:0,totalReportRecords:0},n}return E(e,t),e.prototype.render=function(){var t={name:"/reports/appointments",label:"Xu\u1ea5t b\xe1o c\xe1o h\u1eb9n",breadCumData:[{id:1,text:"Trang Ch\u1ee7",link:"/"},{id:2,text:"Xu\u1ea5t b\xe1o c\xe1o h\u1eb9n",link:"/reports/appointments"}]},e=this.props,n=e.form,r=e.data.loading;return d.createElement("div",null,d.createElement(p.a,{className:"content-header"},t.label,d.createElement(y.c,{breadCumData:t.breadCumData})),d.createElement(p.a,{className:"content-body animated fadeIn"},r?d.createElement(y.p,{size:"large"}):d.createElement("div",null,d.createElement(c.a,{percent:this.state.progress,status:"active"}),d.createElement(p.a,{gutter:16},d.createElement(u.a,{onSubmit:this.handleSubmit},d.createElement(i.a,{xs:24,sm:24,md:24,lg:10},d.createElement(u.a.Item,{label:"Ng\xe0y h\u1eb9n"},n.getFieldDecorator("dateAppointment")(d.createElement(o.a.RangePicker,{showTime:{format:"HH:mm"},format:"YYYY-MM-DD HH:mm",placeholder:["T\u1eeb","\u0110\u1ebfn"]})))),d.createElement(i.a,{xs:24,sm:24,md:24,lg:10},d.createElement(u.a.Item,{label:"Ng\xe0y x\u1eed l\xfd"},n.getFieldDecorator("dateProcessing")(d.createElement(o.a.RangePicker,{format:"YYYY-MM-DD",placeholder:["T\u1eeb","\u0110\u1ebfn"]})))),d.createElement(i.a,{xs:24,sm:24,md:24,lg:4},d.createElement(u.a.Item,null,d.createElement(s.a,{type:"primary",htmlType:"submit",loading:this.state.isSubmitting,disabled:Object($.C)(this.props)},d.createElement(a.a,{type:"download"}),"L\u1ea5y d\u1eef li\u1ec7u"))))))))},e}(d.PureComponent);e.a=Object(h.compose)(Object(b.connect)(function(t,e){return v({userLoggedIn:t.auth.userLoggedIn},e)},null),Object(h.graphql)(S.a,{options:function(){return{variables:{name:P.STATUS_GROUP.ACCEPT_APPOINTMENT}}}}),u.a.create())(_)},2780:function(t,e,n){"use strict";n.d(e,"a",function(){return p}),n.d(e,"c",function(){return l}),n.d(e,"b",function(){return d});var r,a,s,o=n(101),i=n.n(o),u=n(134),c=this&&this.__makeTemplateObject||function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},p=i()(r||(r=c(["\n  ","\n  query AppointmentsReportQueries($name: String!) {\n    statusGroup(name: $name) {\n      ...StatusGroup\n    }\n  }\n"],["\n  ","\n  query AppointmentsReportQueries($name: String!) {\n    statusGroup(name: $name) {\n      ...StatusGroup\n    }\n  }\n"])),u.k),l=i()(a||(a=c(["\n  query TotalRecordReportQuery(\n    $statusIds: [ID!]\n    $dateAppointment: [String!]\n    $dateProcessing: [String!]\n  ) {\n    totalReportRecords(\n      statusIds: $statusIds\n      dateAppointment: $dateAppointment\n      dateProcessing: $dateProcessing\n    )\n  }\n"],["\n  query TotalRecordReportQuery(\n    $statusIds: [ID!]\n    $dateAppointment: [String!]\n    $dateProcessing: [String!]\n  ) {\n    totalReportRecords(\n      statusIds: $statusIds\n      dateAppointment: $dateAppointment\n      dateProcessing: $dateProcessing\n    )\n  }\n"]))),d=i()(s||(s=c(["\n  ","\n  query ReportTableQueries(\n    $statusIds: [ID!]\n    $dateAppointment: [String!]\n    $dateProcessing: [String!]\n    $limit: Int!\n    $offset: Int!\n  ) {\n    report(\n      statusIds: $statusIds\n      dateAppointment: $dateAppointment\n      dateProcessing: $dateProcessing\n      limit: $limit\n      offset: $offset\n    ) {\n      ...Customer\n      user {\n        id\n        name\n        licenseNumber\n        supervisor {\n          id\n          name\n          phoneNumber\n        }\n      }\n    }\n  }\n"],["\n  ","\n  query ReportTableQueries(\n    $statusIds: [ID!]\n    $dateAppointment: [String!]\n    $dateProcessing: [String!]\n    $limit: Int!\n    $offset: Int!\n  ) {\n    report(\n      statusIds: $statusIds\n      dateAppointment: $dateAppointment\n      dateProcessing: $dateProcessing\n      limit: $limit\n      offset: $offset\n    ) {\n      ...Customer\n      user {\n        id\n        name\n        licenseNumber\n        supervisor {\n          id\n          name\n          phoneNumber\n        }\n      }\n    }\n  }\n"])),u.c)}});