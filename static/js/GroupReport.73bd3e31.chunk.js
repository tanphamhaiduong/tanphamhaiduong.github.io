webpackJsonp([29],{2675:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2781);t.default=r.a},2781:function(e,t,n){"use strict";n(228);var r,s=n(19),a=(n(135),n(74)),i=(n(1099),n(618)),o=(n(399),n(290)),u=(n(92),n(78)),c=(n(1100),n(404)),d=(n(227),n(164)),l=(n(292),n(244)),p=n(0),m=(n.n(p),n(41)),f=(n.n(m),n(109)),b=(n.n(f),n(680)),g=n(102),h=(n.n(g),n(1101)),I=n(93),y=n(108),$=n(107),D=n(2782),S=n(149),P=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),E=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},v=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(s,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function o(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?s(e.value):new n(function(t){t(e.value)}).then(i,o)}u((r=r.apply(e,t||[])).next())})},R=this&&this.__generator||function(e,t){var n,r,s,a,i={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(s=r[2&a[0]?"return":a[0]?"throw":"next"])&&!(s=s.call(r,a[1])).done)return s;switch(r=0,s&&(a=[0,s.value]),a[0]){case 0:case 1:s=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(s=(s=i.trys).length>0&&s[s.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!s||a[1]>s[0]&&a[1]<s[3])){i.label=a[1];break}if(6===a[0]&&i.label<s[1]){i.label=s[1],s=a;break}if(s&&i.label<s[2]){i.label=s[2],i.ops.push(a);break}s[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=s=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}},_=function(e){function t(t){var n=e.call(this,t)||this;return n.isHideSubmitting=function(){n.setState({isSubmitting:!1})},n.isResetProgressBar=function(){n.setState({isSubmitting:!0,progress:0,report:[]})},n.getReportData=function(e,t){var r=e.userIds,s=e.dateDistribute,a=e.dateProcessing,i=e.statusIds,o=e.index;return h.a.query({query:D.b,variables:{userIds:r,dateDistribute:s,dateProcessing:a,statusIds:i,limit:y.TABLE.ITEMS_PER_PAGE,offset:(o-1)*y.TABLE.ITEMS_PER_PAGE}}).then(function(e){var r=e.data,s=n.state,a=s.report,i=s.totalReportRecords,o=0;i>0&&(o=Math.floor(100*(r.report.length+a.length)/i)),n.setState({report:a.concat(r.report),progress:o<=100?o:0}),t()}).catch(function(e){console.error(e),t()})},n.handleSubmit=function(e){e.preventDefault(),n.props.form.validateFields(function(e,t){return v(n,void 0,void 0,function(){var n,r,s,a,i,o,u,c,d,p=this;return R(this,function(g){switch(g.label){case 0:if(e)return[3,4];g.label=1;case 1:return g.trys.push([1,3,,4]),this.isResetProgressBar(),n=t.dateDistribute,r=t.dateProcessing,s=f.get(this.props.data,"statusGroup.statusesInGroup","").split(","),a=this.props.data.users.map(function(e){return e.id}),[4,h.a.query({query:D.c,variables:{userIds:a,dateDistribute:n,dateProcessing:r,statusIds:s}})];case 2:if(i=g.sent().data,(o=i.totalReportRecords)<1)return this.isHideSubmitting(),[2,l.a.info({message:"L\u1ed7i",description:"Kh\xf4ng c\xf3 d\u1eef li\u1ec7u \u0111\u1ec3 l\u1ea5y"})];for(this.setState({totalReportRecords:o}),u=b.queue(1),c=1;c<=Math.ceil(o/y.TABLE.ITEMS_PER_PAGE);c++)u.defer(this.getReportData,{userIds:a,dateDistribute:n,dateProcessing:r,statusIds:s,index:c});return u.awaitAll(function(){var e=p.state.report,t=Object($.z)(e,Object($.q)(p.props.userLoggedIn.role.permissions));p.isHideSubmitting(),Object($.n)(t,"customers","report"+m(Date.now()).format("DDMMMYYYY").toString())}),[3,4];case 3:return d=g.sent(),console.error(d),this.isHideSubmitting(),Object($.o)(d),[3,4];case 4:return[2]}})})})},n.state={report:[],isSubmitting:!1,progress:0,totalReportRecords:0},n}return P(t,e),t.prototype.render=function(){var e={name:"/reports/group/customers",label:"Xu\u1ea5t b\xe1o c\xe1o nh\xf3m",breadCumData:[{id:1,text:"Trang Ch\u1ee7",link:"/"},{id:2,text:"B\xe1o c\xe1o nh\xf3m",link:"/reports/group/customers"}]},t=this.props,n=t.form,r=t.data.loading;return p.createElement("div",null,p.createElement(d.a,{className:"content-header"},e.label,p.createElement(I.c,{breadCumData:e.breadCumData})),p.createElement(d.a,{className:"content-body animated fadeIn"},r?p.createElement(I.p,{size:"large"}):p.createElement("div",null,p.createElement(c.a,{percent:this.state.progress,status:"active"}),p.createElement(u.a,{onSubmit:this.handleSubmit},p.createElement(d.a,{gutter:16},p.createElement(o.a,{xs:24,sm:24,md:24,lg:10},p.createElement(u.a.Item,{label:"Ng\xe0y ph\xe1t d\u1eef li\u1ec7u"},n.getFieldDecorator("dateDistribute")(p.createElement(i.a.RangePicker,{showTime:{format:"HH:mm"},format:"YYYY-MM-DD HH:mm",placeholder:["Start Time","End Time"]})))),p.createElement(o.a,{xs:24,sm:24,md:24,lg:10},p.createElement(u.a.Item,{label:"Ng\xe0y x\u1eed l\xfd"},n.getFieldDecorator("dateProcessing")(p.createElement(i.a.RangePicker,{format:"YYYY-MM-DD",placeholder:["Start Time","End Time"]})))),p.createElement(o.a,{xs:24,sm:24,md:24,lg:4},p.createElement(u.a.Item,null,p.createElement(a.a,{type:"primary",htmlType:"submit",loading:this.state.isSubmitting,disabled:Object($.C)(this.props)},p.createElement(s.a,{type:"download"}),"L\u1ea5y d\u1eef li\u1ec7u"))))))))},t}(p.PureComponent);t.a=Object(g.compose)(Object(S.connect)(function(e,t){return E({userLoggedIn:e.auth.userLoggedIn},t)},null),Object(g.graphql)(D.a,{options:function(){return{variables:{name:y.STATUS_GROUP.CHANGED_STATUS}}}}),u.a.create())(_)},2782:function(e,t,n){"use strict";n.d(t,"a",function(){return d}),n.d(t,"c",function(){return l}),n.d(t,"b",function(){return p});var r,s,a,i=n(101),o=n.n(i),u=n(134),c=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},d=o()(r||(r=c(["\n  ","\n  query GroupReportQueries($name: String!) {\n    statusGroup(name: $name) {\n      ...StatusGroup\n    }\n    users {\n      id\n    }\n  }\n"],["\n  ","\n  query GroupReportQueries($name: String!) {\n    statusGroup(name: $name) {\n      ...StatusGroup\n    }\n    users {\n      id\n    }\n  }\n"])),u.k),l=o()(s||(s=c(["\n  query TotalRecordReportQuery(\n    $userIds: [ID!]\n    $statusIds: [ID!]\n    $dateDistribute: [String!]\n    $dateProcessing: [String!]\n  ) {\n    totalReportRecords(\n      userIds: $userIds\n      statusIds: $statusIds\n      dateDistribute: $dateDistribute\n      dateProcessing: $dateProcessing\n    )\n  }\n"],["\n  query TotalRecordReportQuery(\n    $userIds: [ID!]\n    $statusIds: [ID!]\n    $dateDistribute: [String!]\n    $dateProcessing: [String!]\n  ) {\n    totalReportRecords(\n      userIds: $userIds\n      statusIds: $statusIds\n      dateDistribute: $dateDistribute\n      dateProcessing: $dateProcessing\n    )\n  }\n"]))),p=o()(a||(a=c(["\n  ","\n  query ReportTableQueries(\n    $userIds: [ID!]\n    $statusIds: [ID!]\n    $dateDistribute: [String!]\n    $dateProcessing: [String!]\n    $limit: Int!\n    $offset: Int!\n  ) {\n    report(\n      userIds: $userIds\n      statusIds: $statusIds\n      dateDistribute: $dateDistribute\n      dateProcessing: $dateProcessing\n      limit: $limit\n      offset: $offset\n    ) {\n      ...Customer\n      user {\n        id\n        name\n        licenseNumber\n        supervisor {\n          id\n          name\n          phoneNumber\n        }\n      }\n    }\n  }\n"],["\n  ","\n  query ReportTableQueries(\n    $userIds: [ID!]\n    $statusIds: [ID!]\n    $dateDistribute: [String!]\n    $dateProcessing: [String!]\n    $limit: Int!\n    $offset: Int!\n  ) {\n    report(\n      userIds: $userIds\n      statusIds: $statusIds\n      dateDistribute: $dateDistribute\n      dateProcessing: $dateProcessing\n      limit: $limit\n      offset: $offset\n    ) {\n      ...Customer\n      user {\n        id\n        name\n        licenseNumber\n        supervisor {\n          id\n          name\n          phoneNumber\n        }\n      }\n    }\n  }\n"])),u.c)}});